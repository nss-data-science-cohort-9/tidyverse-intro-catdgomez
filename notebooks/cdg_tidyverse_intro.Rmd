---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 


```{r}

```


```{r}
library(tidyverse)
```


1. Using the read_csv() function, read the GDP dataset into your notebook as a tibble called gdp_df. After reading it in, inspect the first 10 rows and then inspect the last 10 rows.


```{r}

gdp_df <- read_csv("../data/gdp_per_capita.csv")

head(gdp_df, 10)

```

```{r}
tail(gdp_df, 10)
```


2. Drop the 'Value Footnotes' column, and rename the remaining columns to 'Country', 'Year', and 'GDP_Per_Capita'.

```{r}

gdp_df_drop <- gdp_df |> 
  select(-`Value Footnotes`)


gdp_df_drop

```


```{r}

gdp_df_drop_rename <- gdp_df_drop |> 
  rename(c(GDP_Per_Capita = Value, Country = `Country or Area`))

gdp_df_drop_rename
```

3. Which years are represented in this dataset? How many observations are there per year? Make a plot to view the number of observations per year.

```{r}
min(gdp_df_drop_rename[,2])
max(gdp_df_drop_rename[,2])
```

How many observations are there per year? 

```{r}
no_obsv_year <- gdp_df_drop_rename |> 
  count(Year)
no_obsv_year
```

Make a plot to view the number of observations per year.

```{r}
no_obsv_year |> 
  ggplot(aes(x = Year, y = n)) + 
    geom_col()
```

4. How many countries are represented in this dataset? Which countries have the fewest observations?


```{r}

no_obsv_ctry <- gdp_df_drop_rename |> 
  count(Country)
no_obsv_ctry

```


```{r}

gdp_df_drop_rename |> 
  distinct(Country[!is.na(Country)])

gdp_df_drop_rename |> 
  distinct(Country)

```

```{r}

length(unique(gdp_df_drop_rename$Country))

```

Which countries have the fewest observations?

```{r}

min(no_obsv_ctry$n)
# SORT DESC TAIL
```


```{r}
no_obsv_ctry |> 
  mutate(freq = min(n))

```


```{r}

tail(sort(no_obsv_ctry$Country), 3)

```


```{r}
# no_obsv_ctry[, min("n"), by=c("Country","n")]
with(unique(no_obsv_ctry[c("Country", "n")]), table(no_obsv_ctry))
```
```{r}
table(gdp_df_drop_rename$Country)
```

```{r}

num_obsv_ctry <- gdp_df_drop_rename |> 
  count(Country, sort = TRUE, name = "num_obsv_of_ctry")
tail(num_obsv_ctry)

```


```{r}
lowest_num_obsrv_ctry <- num_obsv_ctry |> 
  arrange(num_obsv_of_ctry) |> 
  slice(1:5)
lowest_num_obsrv_ctry
```


```{r}
min(num_obsv_ctry$num_obsv_of_ctry, na.rm = TRUE)
```
5. Create a new tibble by subsetting gdp_df to just the year 2021. Call this new tibble gdp_2021.

```{r}

# gdp_2021 <- gdp_df_drop_rename |> 
#   (gdp_df_drop_rename$Year %in% 2021)

```


```{r}

gdp_2021 <- gdp_df_drop_rename |> 
  filter(Year == "2021")

gdp_2021

```

```{r}
gdp_2021 |> 
  count(Year)
min(gdp_2021[,2])
max(gdp_2021[,2])
```
6. Use summary() to find the summary statistics for GDP per capita in 2021.

```{r}

summary(gdp_2021$GDP_Per_Capita)
summary(gdp_2021)

```

7. Create a histogram of GDP Per Capita numbers for 2021 (you may wish to adjust the number of bins for your histogram).


```{r}

ggplot( gdp_2021, aes( x= GDP_Per_Capita ) ) +
  geom_histogram( bins=50, color = "white", fill = "skyblue4" ) +
  labs(
    title = "Histogram of GDP Per Capita (2021)",
    x = "GDP per Capita (Current US$)",
    y = "Frequency (Number of Countries)"
  )

```
8. Find the top 5 counties and bottom 5 countries by GDP per capita in 2021.

```{r}


```


```{r}
```


```{r}
```


```{r}
```


```{r}
```


```{r}
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.